function createBox(value = 2, x = 0, y = 0) {
    const box = document.createElement('div');
    box.className = 'box';
    box.dataset.value = value;
    box.textContent = value;
    box.style.left = x + 'px';
    box.style.top = y + 'px';

    // Set background color based on the box value
    box.style.backgroundColor = getBoxColor(value);

    // Add click handler for duplication
    box.addEventListener('mousedown', (e) => {
        if (e.ctrlKey || e.metaKey) {
            // Duplicate only on Ctrl/Cmd + click
            const rect = box.getBoundingClientRect();
            createBox(parseInt(box.dataset.value), rect.left + 120, rect.top);
            e.stopPropagation();
        } else {
            // Regular click for dragging
            startDragging(e);
        }
    });

    document.body.appendChild(box);
    boxCount++;
    return box;
}

// Function to get a color based on the box value
function getBoxColor(value) {
    // Simple example of generating a color dynamically based on the value
    const colors = [
        '#3498db', // 2
        '#2ecc71', // 4
        '#e74c3c', // 8
        '#9b59b6', // 16
        '#f1c40f', // 32
        '#e67e22', // 64
        '#1abc9c'  // 128
    ];

    // If the value is larger than 128, generate a color based on its power of 2
    if (value <= 128) {
        return colors[Math.log2(value) - 1];
    } else {
        // Generate a color for values larger than 128
        const shade = Math.min(255, 255 - (Math.log2(value) * 10));
        return `rgb(${shade}, ${Math.floor(shade / 2)}, ${Math.floor(shade / 3)})`;
    }
}
